function ejecucion(){if(document.querySelectorAll("#product-page").length>0)for(var idp=document.querySelectorAll("#___rc-p-id"),sku=document.querySelectorAll(".sku-selector-container"),nombre=document.querySelectorAll(".product-details .productName"),imagen=document.querySelectorAll("#image-main"),i=0;i<1;i++)imagen=imagen[0].src,idp=idp[0].value,sku=sku[0].textContent,nombre=nombre[0].textContent,ruta=window.location.href,"mail","activo"}function salida_usuario(){if(document.querySelectorAll("#account-page").length>0){document.querySelector(".vtex-account__menu nav a:last-child").onclick=function(){setTimeout(function(){var salida=document.querySelectorAll(".vtex-modal__confirmation .vtex-button"),boton_salida=salida[1];document.querySelector(".vtex-modal__confirmation .vtex-button");boton_salida.onclick=function(){localStorage.removeItem("login:")}},100)}}}function ventanaperfil(){vtexjs.checkout.getOrderForm().done(function(orderForm){if(document.querySelectorAll("#product-page").length>0)if(orderForm.loggedIn)console.log("Usuario logueado: ",orderForm.clientProfileData.email);else{var boton_deseos=document.querySelectorAll(".wishlist"),url_redic2=window.location.href.split("/");console.log(url_redic2),localStorage.setItem("favoritos:",url_redic2[3]),boton_deseos[1].innerHTML="<a href='/login?ReturnUrl="+url_redic2[3]+"/p'><img src='/arquivos/wishlist-icon-pdp.png?v=637575695864430000'>Agregar a lista de deseos.</a>"}})}function perfil(){if(document.querySelectorAll("#account-page").length>0){for(var email=document.querySelectorAll(".vtex-profile-form__profile-summary .mb8"),i=0;i<1;i++)email=email[2].querySelector(".c-on-disabled").textContent,localStorage.setItem("login:",email);if(!localStorage.getItem("favoritos:"))return;localStorage.getItem("favoritos:");setInterval(function(){window.location.href="https://tuissco.myvtex.com/"},10),setTimeout(function(){localStorage.removeItem("favoritos:")},100)}}function datos_ocultos(){document.querySelectorAll("#product-page").length>0&&(document.getElementsByClassName("modal-deseos")[0].style.display="none")}vtexjs.checkout.getOrderForm().done(function(orderForm){orderForm.loggedIn?console.log("Usuario logueado: ",orderForm.clientProfileData.email):console.log("Usuario no logueado2"),setInterval(()=>{var productID=document.querySelectorAll("#product-content .product-info .product-name #___rc-p-id")[0]?document.querySelectorAll("#product-content .product-info .product-name #___rc-p-id")[0].value:null;fetch("/api/dataentities/PA/search?_fields=productID&_where=(productID="+productID+")",{method:"GET",headers:{"Content-Type":"application/json","X-VTEX-API-AppKey":"vtexappkey-tuissarg-RSRUNA","X-VTEX-API-AppToken":"DRAHJNOACVXXTAZSSFZZYKVDNVBXGTWTMYITWADZGHWFCYMJKYJBRCSSWXTNLRTIZELUSFVSCATQOPBPISMHKUBJGPXZGPNPNNGXNSRFCRYQJBEGVEFTELYECBNCHWLN"}}).then(function(response){return response.json()}).then(function(data2){data2.orderId})},5e3)}),setTimeout(function(){salida_usuario()},3e3),ventanaperfil(),setTimeout(function(){perfil()},5e3),datos_ocultos();const removeProductWhishlist=async(email,id,idp,sku,ruta,nombre,imagen,lista)=>{const productElement=parseInt($(document).find("#articulos").length-1),enumeradorElement=$(document).find(`#enumerador_${lista.toLowerCase()}`),data={id:id,idp:idp,sku:sku,ruta:ruta,nombre:nombre,imagen:imagen,activo:!1,email:email},remove=await fetch("/api/dataentities/WH/documents",{method:"PATCH",body:JSON.stringify(data),headers:{"Content-Type":"application/json","X-VTEX-API-AppKey":"vtexappkey-tuissarg-RSRUNA","X-VTEX-API-AppToken":"DRAHJNOACVXXTAZSSFZZYKVDNVBXGTWTMYITWADZGHWFCYMJKYJBRCSSWXTNLRTIZELUSFVSCATQOPBPISMHKUBJGPXZGPNPNNGXNSRFCRYQJBEGVEFTELYECBNCHWLN"}});(await remove.json()).Message&&console.error("Error in Update",data),enumeradorElement.html(`( ${productElement} ) Productos`),0===productElement&&(enumeradorElement.remove(),$(document).find(`#${lista.toLowerCase()}`).html('<div class="notFoundProduct"><h2> No se encuentran productos ðŸ˜¢ </h2></div>')),$(document).find(`#${lista.toLowerCase()} .product-${idp}`).fadeOut(300,()=>{$(document).find(`#${lista.toLowerCase()} .product-${idp}`).remove()})};async function pintarDeseos(){document.querySelectorAll("#deseos-page-body").length>0&&(loader($(".acordeon_deseos")),listAccordion())}const loader=element=>{$(element).html('\n\t\t<div class="loader">\n\t\t\t<div class="lds-ellipsis">\n\t\t\t\t<div></div>\n\t\t\t\t<div></div>\n\t\t\t\t<div></div>\n\t\t\t\t<div></div>\n\t\t\t</div>\n\t\t</div>\n\t')},listAccordion=async()=>{const vtexOrder=await vtexjs.checkout.getOrderForm(),{clientProfileData:{email:email}}=vtexOrder,elementParentAccordion=$(".acordeon_deseos"),totalListElement=$(".total_listas"),searchUrlLists=`/api/dataentities/WH/search?_fields=id,nombre&_where=(tipo=LIST AND activo=True AND email=${email})`,searchList=await fetch(searchUrlLists),searchListJson=await searchList.json();setTimeout(()=>{if(200===searchList.status){elementParentAccordion.html(""),elementParentAccordion.append("\n\t\t\t\t<div class=\"accordionContainer\">\n\t\t\t\t\t<button class='accordion' data-list='favoritos'>Mis Favoritos</button>\n\t\t\t\t\t<div class=\"iconsDefault\">\n\t\t\t\t\t\t<span class=\"\">\n\t\t\t\t\t\t\t<img src=\"/arquivos/edit-ico.png\">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"\">\n\t\t\t\t\t\t\t<img src=\"/arquivos/delete-ico.png\">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<span class='enumerador' id='enumerador_favoritos'></span>\n\t\t\t\t<div class='panel' id='favoritos'>\n\t\t\t\t</div>\n\t\t\t"),searchListJson.length?(searchListJson.forEach(element=>{const nameList=element.nombre.toLowerCase();console.log("Element",element),elementParentAccordion.append(`\n\t\t\t\t\t\t<div class="accordionContainer">\n\t\t\t\t\t\t\t<button class='accordion' data-list='${nameList}'>\n\t\t\t\t\t\t\t\t${nameList.charAt(0).toUpperCase()+nameList.slice(1).replace("_"," ")}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<div class="icons">\n\t\t\t\t\t\t\t\t<span class="edit" onclick="onEditList('${nameList}', '${element.id}')">\n\t\t\t\t\t\t\t\t\t<img src="/arquivos/edit-ico.png">\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span class="delete" onclick="onDeleteList('${nameList}', '${element.id}')">\n\t\t\t\t\t\t\t\t\t<img src="/arquivos/delete-ico.png">\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<span class='enumerador' id='enumerador_${nameList}'></span>\n\t\t\t\t\t\t<div class='panel' id='${nameList}'>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`)}),totalListElement.html(`Total de listas encontradas ( ${searchListJson.length+1} )`)):totalListElement.html("Total de listas encontradas ( 1 )"),$(document).find(".accordion").map((index,element)=>{$(element).on("click",e=>onEventListAccordion(e))})}},3e3)},onEditList=(list,id)=>{const modalElement=$(document).find(".modal-deseos");$(modalElement).find("#titulo-deseos").html("<img src='/arquivos/mas-icon.png'></img> EDITAR LISTA"),$(modalElement).find(".entrada_listas_datos").html(`\n\t\t<input class="lista_name" value="${list.charAt(0).toUpperCase()+list.slice(1).replace("_"," ")}" spellcheck="false" data-ms-editor="true">\n\t\t<div class="update_lista" style="cursor: pointer;">OK</div>\n\t`),$(modalElement).find(".entrada_listas_datos .lista_name").focus(),modalElement.css("display","flex"),$(document).find(".update_lista").on("click",async()=>{const nombre=$(document).find(".lista_name").val().replace(" ","_"),data={id:id,nombre:nombre},remove=await fetch("/api/dataentities/WH/documents",{method:"PATCH",body:JSON.stringify(data),headers:{"Content-Type":"application/json","X-VTEX-API-AppKey":"vtexappkey-tuissarg-RSRUNA","X-VTEX-API-AppToken":"DRAHJNOACVXXTAZSSFZZYKVDNVBXGTWTMYITWADZGHWFCYMJKYJBRCSSWXTNLRTIZELUSFVSCATQOPBPISMHKUBJGPXZGPNPNNGXNSRFCRYQJBEGVEFTELYECBNCHWLN"}});(await remove.json()).Message&&console.error("Error in Update",data),$(document).find(".entrada_listas_datos").html('<div class="modalResponse"><h2>Actualizado correctamente ðŸ¥³</h2></div>')})},onDeleteList=(list,id)=>{const modalElement=$(document).find(".modal-deseos");$(modalElement).find("#titulo-deseos").html("<img src='/arquivos/mas-icon.png'></img> ELIMINAR LISTA"),$(modalElement).find(".entrada_listas_datos").html(`\n\t\t<h2 style="margin-right: 1rem;">Â¿ EstÃ¡s seguro de eliminar la lista <b> ${list.charAt(0).toUpperCase()+list.slice(1).replace("_"," ")} </b> ?</h2></br>\n\t\t<div class="delete_lista" style="cursor: pointer;">OK</div>\n\t`),modalElement.css("display","flex"),$(document).find(".delete_lista").on("click",async()=>{const data={id:id,activo:"False"},remove=await fetch("/api/dataentities/WH/documents",{method:"PATCH",body:JSON.stringify(data),headers:{"Content-Type":"application/json","X-VTEX-API-AppKey":"vtexappkey-tuissarg-RSRUNA","X-VTEX-API-AppToken":"DRAHJNOACVXXTAZSSFZZYKVDNVBXGTWTMYITWADZGHWFCYMJKYJBRCSSWXTNLRTIZELUSFVSCATQOPBPISMHKUBJGPXZGPNPNNGXNSRFCRYQJBEGVEFTELYECBNCHWLN"}});(await remove.json()).Message&&console.error("Error in Update",data),$(document).find(".entrada_listas_datos").html('<div class="modalResponse"><h2>Eliminado correctamente ðŸ¥³</h2></div>')})},onEventListAccordion=e=>{const panelId=$(e.target).data("list"),elementPanel=$(document).find(`#${panelId}`),elementEnumerador=$(document).find(`#enumerador_${panelId}`);$(e.target).toggleClass("active"),$(e.target).hasClass("active")?(loader(elementPanel),productToList(panelId),elementPanel.css("display","flex"),elementEnumerador.css("display","block")):(elementPanel.css("display","none"),elementEnumerador.css("display","none"))},productToList=async panel=>{const vtexOrder=await vtexjs.checkout.getOrderForm(),{clientProfileData:{email:email}}=vtexOrder,searchUrl=`/api/dataentities/WH/search?_fields=id,activo,idp,imagen,nombre,lista,ruta,sku&_where=(activo="true" AND tipo="PRODUCT" AND lista="${panel.toUpperCase()}" AND email="${email}")`,search=await fetch(searchUrl),searchJson=await search.json(),elementPanel=$(document).find(`#${panel}`);console.log("searchJson",searchJson),searchJson.length?(elementPanel.html(""),$(document).find(`#enumerador_${panel}`).text(`( ${searchJson.length} ) Productos`),searchJson.forEach(element=>{const{id:id,idp:idp,sku:sku,ruta:ruta,nombre:nombre,imagen:imagen,lista:lista}=element;let htmlColors="";sku.split("#").forEach(color=>{"Color"!=color&&(htmlColors+=`<a style='background: #${color};  border: 1px solid #9d9d9c; font-size: 0;width: 25px;height: 25px;border-radius: 50%;'> ${color} </a>`)}),elementPanel.append(`\n\t\t\t\t<div id='articulos' class="product-${idp}">\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<a href="${ruta}">\n\t\t\t\t\t\t\t\t<img src="${imagen}"></img>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t<span class='deleteProduct' onclick="removeProductWhishlist( '${email}', '${id}', '${idp}', '${sku}', '${ruta}', '${nombre}', '${imagen}', '${lista}' )">\n\t\t\t\t\t\t\t\t<img  width='20px' src='/arquivos/corazon.png'></img>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class='.product-name a' style='margin-top: 1rem;text-align: justify;'>\n\t\t\t\t\t\t\t<a>${nombre}</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<h3>Color:</h3>\n\t\t\t\t\t\t<div style='display: flex;'>\n\t\t\t\t\t\t\t${htmlColors}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</li>\n\t\t\t\t</div>\n\t\t\t`)})):elementPanel.html('<div class="notFoundProduct"><h2> No se encuentran productos ðŸ˜¢ </h2></div>')};var ListaDeseos={init:function(){screen.width;this.FormularioDeseos(),this.EnvioFormulario(),this.Crear_nueva_lista(),this.EntradaListas(),this.RevivirFormularios(),this.ReenvioDeseos()},RevivirFormularios:function(){$(".mis_deseos").on("click",function(c){vtexjs.checkout.getOrderForm().done(function(orderForm){document.getElementsByClassName("input-remplazo")[0].innerHTML="<select  class='lista_name' name='select'><option selected='selected' value='FAVORITOS'>Mis Favoritos</option></select></div>";var email=orderForm.clientProfileData.email;fetch("/api/dataentities/WH/search?_fields=activo,idp,imagen,nombre,ruta,sku&_where=(activo=lista AND email="+email+")",{method:"GET",headers:{"Content-Type":"application/json","X-VTEX-API-AppKey":"vtexappkey-tuissarg-RSRUNA","X-VTEX-API-AppToken":"DRAHJNOACVXXTAZSSFZZYKVDNVBXGTWTMYITWADZGHWFCYMJKYJBRCSSWXTNLRTIZELUSFVSCATQOPBPISMHKUBJGPXZGPNPNNGXNSRFCRYQJBEGVEFTELYECBNCHWLN"}}).then(function(response){return response.json()}).then(function(data4){var mis_listas=document.getElementsByClassName("lista_name");const base_datos_listas=[];for(var i=0;i<data4.length;i++)base_datos_listas.push(data4[i].nombre),mis_listas[0].innerHTML+="<option  value="+data4[i].idp+"-"+data4[i].nombre+">"+data4[i].nombre.split("_").join(" ")+"</option>";const favoritos=new Set(base_datos_listas);cantidad_listas=favoritos.size})})})},EnvioFormulario:function(){$(".wishlist").on("click",async function(c){const vtexOrder=await vtexjs.checkout.getOrderForm(),{clientProfileData:{email:email}}=vtexOrder,elementList=$(".lista_name"),searchUrl=`/api/dataentities/WH/search?_fields=nombre&_where=(activo=true AND tipo=LIST AND email=${email})`,searchList=await fetch(searchUrl),searchListJson=await searchList.json();searchListJson.length&&searchListJson.forEach(element=>{console.log("Element: ",element);const nameList=element.nombre.toLowerCase();elementList.append(`<option value="${element.nombre}">${nameList.charAt(0).toUpperCase()+nameList.slice(1).replace("_"," ")}</option>`)}),document.getElementsByClassName("modal-deseos")[0].style.display="flex"})},EntradaListas:function(){$(".hacer_lista").on("click",async function(c){c.preventDefault();const lista=$(".lista_name").val(),elementList=$(".lista_name"),elementParentList=$(".entrada_listas_datos"),searchUrl=`/api/dataentities/WH/search?_fields=activo,idp,imagen,nombre,ruta,sku&_where=(nombre="${lista}")`,searchList=await fetch(searchUrl);if((await searchList.json()).length){document.querySelector("#titulo-deseos").innerHTML='<img src="/arquivos/mas-icon.png">LA LISTA YA EXISTE'}else{const vtexOrder=await vtexjs.checkout.getOrderForm(),{clientProfileData:{email:email}}=vtexOrder,data={idp:null,sku:null,email:email,nombre:elementList.val().toUpperCase(),ruta:null,imagen:null,activo:!0,lista:null,tipo:"LIST"};if(201!=(await fetch("/api/dataentities/WH/documents",{method:"POST",body:JSON.stringify(data),headers:{"Content-Type":"application/json"}})).status)return void console.error("Error in Creation of List");console.info("List Created"),elementParentList.hide(),$("#titulo-deseos").fadeIn(),$("#titulo-deseos").empty().append('<img style="width:40px; height:40px;" src="/arquivos/exito-icon.png"></img><h3 style="font-size:12px">Â¡AGREGADO CON Ã‰XITO!</3>'),setTimeout(function(){$("#titulo-deseos").fadeOut(),location.reload(!0)},1e4)}})},ReenvioDeseos:function(){$(".hacer_lista").on("click",function(e){vtexjs.checkout.getOrderForm().done(function(orderForm){e.preventDefault();document.querySelector(".lista_name").value.toUpperCase().split(" ").join("_")})})},FormularioDeseos:function(){$(".enviar_lista").on("click",function(e){e.preventDefault(),vtexjs.checkout.getOrderForm().done(function(orderForm){e.preventDefault();const listElement=$(".lista_name");var idp=skuJson.productId,sku=$(".sku-selector-container");sku=sku[0].textContent;var email=orderForm.clientProfileData.email;email=email;var nombre=$(".product-details .productName");nombre=nombre[0].textContent;var ruta=window.location.href,imagen=$("#image-main"),datosToSave={idp:idp,sku:sku,email:email,nombre:nombre,ruta:ruta,imagen:imagen=imagen[0].src,activo:!0,tipo:"PRODUCT",lista:listElement.val()};$.ajax({url:"/api/dataentities/WH/documents",data:JSON.stringify(datosToSave),contentType:"application/json; charset=utf-8",type:"POST",success:function(data){console.log("success"),document.getElementsByClassName("entrada_listas_datos")[0].style.display="none",$("#titulo-deseos").fadeIn(),$("#titulo-deseos").empty().append('<img style="width:40px; height:40px;" src="/arquivos/exito-icon.png"></img><h3 style="font-size:12px">Â¡AGREGADO CON Ã‰XITO!</3>'),setTimeout(function(){$("#titulo-deseos").fadeOut(),location.reload(!0)},1e4)},error:function(error){if(console.log(error.responseText),400==error.status){var response=JSON.parse(error.responseText);$(".mensaje").fadeIn(),"duplicated entry"==response.Message?$(".mensaje").empty().append("<p>ERROR DE FORMULARIO</p>"):$(".mensaje").empty().append("<p>Lo sentimos, ha ocurrido un error</p>"),setTimeout(function(){$(".mensaje").fadeOut()},5e3)}}})})})},Crear_nueva_lista:function(){if(document.querySelectorAll("#product-page").length>0){var crear_lista=document.getElementsByClassName("input-remplazo"),ocultar_atributo=document.querySelectorAll(".deseo_crear"),mis_deseos=document.querySelectorAll(".mis_deseos");mis_deseos[0].style.display="none";var boton_crear=document.getElementsByClassName("hacer_lista");boton_crear[0].style.display="none";var enviar_datos=document.getElementsByClassName("enviar_lista");enviar_datos[0].style.display="flex",$(".deseo_crear").on("click",function(c){boton_crear[0].style.display="flex",enviar_datos[0].style.display="none",crear_lista[0].innerHTML="<input placeholder='Crear un nueva lista' class='lista_name'></input>",ocultar_atributo[0].style.display="block",mis_deseos[0].style.display="block"}),$(".mis_deseos").on("click",function(c){boton_crear[0].style.display="none",enviar_datos[0].style.display="flex",ocultar_atributo[0].style.display="block",mis_deseos[0].style.display="none"})}}};function Cerrar_Ventanas(){if(document.querySelectorAll("#deseos-page-body").length>0){function cerrarModal(){document.querySelector(".modal-deseos").style.display="none",location.reload()}document.querySelector(".close-modal").onclick=cerrarModal}if(document.querySelectorAll("#login-page").length>0){function cerrarModal(){window.location.href="https://tuissco.myvtex.com/"}document.querySelector(".close-login").onclick=cerrarModal}if(document.querySelectorAll("#product-page").length>0){function cerrarModal(){document.querySelector(".modal-deseos").style.display="none",location.reload()}document.querySelector(".close-modal").onclick=cerrarModal}}$(document).ready(function(){vtexjs.checkout.getOrderForm().done(function(orderForm){orderForm.loggedIn&&(document.querySelectorAll("#product-page").length>0&&ListaDeseos.init(),pintarDeseos())})}),Cerrar_Ventanas();